
#include <behaviors.dtsi>

#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/pointing.h>

#include <dt-bindings/zmk/ext_power.h>

/ {
    behaviors {
        #include "macros.dtsi"

        hm: homerow_mods {
            compatible = "zmk,behavior-hold-tap";
            label = "HOMEROW_MODS";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            quick_tap_ms = <175>;
            flavor = "tap-preferred";
            bindings = <&kp>, <&kp>;
        };
        hml: home_mod_left {
            compatible = "zmk,behavior-hold-tap";
            label = "HOME_MOD_LEFT";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <175>;
            bindings = <&kp>, <&kp>;
            // Triggers on Left Side Keys
            hold-trigger-key-positions = <6 7 8 9 10 11  18 19 20 21 22 23  30 31 32 33 34 35  43 44 45 46 47 48 49  50 51 52 53 54 55 56 57>;
        };
        hmr: home_mod_right {
            compatible = "zmk,behavior-hold-tap";
            label = "HOME_MOD_RIGHT";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <175>;
            bindings = <&kp>, <&kp>;
            // Triggers on Right Side Keys
            hold-trigger-key-positions = <0 1 2 3 4 5  12 13 14 15 16 17  24 25 26 27 28 29  36 37 38 39 40 41 42  50 51 52 53 54 55 56 57>;
        };
        mmr: mirror_mod_right {
            compatible = "zmk,behavior-hold-tap";
            label = "MIRROR_MOD_RIGHT";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <175>;
            bindings = <&kp>, <&kp>;
            // Triggers on Right Side Keys
            hold-trigger-key-positions = <6 7 8 9 10 11  18 19 20 21 22 23  30 31 32 33 34 35  43 44 45 46 47 48 49  54 55 56 57>;
        };
        mml: mirror_mod_left {
            compatible = "zmk,behavior-hold-tap";
            label = "MIRROR_MOD_LEFT";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <175>;
            bindings = <&kp>, <&kp>;
            // Triggers on Left Side Keys
            hold-trigger-key-positions = <0 1 2 3 4 5  12 13 14 15 16 17  24 25 26 27 28 29  36 37 38 39 40 41 42  50 51 52 53>;
        };
        mlr: mirror_layer_right {
            compatible = "zmk,behavior-hold-tap";
            label = "MIRROR_LAYER_RIGHT";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <175>;
            bindings = <&mo>, <&kp>;
            // Triggers on Right Side Keys
            hold-trigger-key-positions = <6 7 8 9 10 11  18 19 20 21 22 23  30 31 32 33 34 35  43 44 45 46 47 48 49  54 55 56 57>;
        };
        mll: mirror_layer_left {
            compatible = "zmk,behavior-hold-tap";
            label = "MIRROR_LAYER_LEFT";
            #binding-cells = <2>;
            flavor = "tap-preferred";
            tapping-term-ms = <200>;
            quick-tap-ms = <175>;
            bindings = <&mo>, <&kp>;
            // Triggers on Left Side Keys
            hold-trigger-key-positions = <0 1 2 3 4 5  12 13 14 15 16 17  24 25 26 27 28 29  36 37 38 39 40 41 42  50 51 52 53>;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        default_layer {
            display-name = "base";
            bindings = <
&kp GRAVE          &kp N1            &kp N2            &kp N3            &kp N4             &kp N5                               &kp N6  &kp N7             &kp N8             &kp N9              &kp N0               &kp MINUS
&kp ESCAPE         &kp Q             &kp W             &kp E             &kp R              &kp T                                &kp Y   &kp U              &kp I              &kp O               &kp P                &kp EQUAL
&kp LEFT_BRACKET   &kp A             &kp S             &kp D             &kp F              &kp G                                &kp H   &kp J              &kp K              &kp L               &kp SEMI             &kp SQT
&kp RIGHT_BRACKET  &hml LCTRL Z      &hml LALT X       &hml LCMD C       &hml LSHFT V       &kp B   &none                &none   &kp N   &hmr RSHFT M       &hmr RCMD COMMA    &hmr RALT DOT       &hmr RCTRL FSLH      &kp BACKSLASH
                                        &mll 1 SPACE &mml LEFT_SHIFT TAB &mll 2 GRAVE     &none   &none   &mlr 2 ENTER &mmr RIGHT_SHIFT BACKSPACE &mlr 1 SPACE
            >;
        };

        layer_esab {
            display-name = "esab";
            bindings = <
&kp MINUS         &kp N0             &kp N9             &kp N8             &kp N7             &kp N6                               &kp N5  &kp N4             &kp N3             &kp N2              &kp N1               &kp GRAVE
&kp EQUAL         &kp P              &kp O              &kp I              &kp U              &kp Y                                &kp T   &kp R              &kp E              &kp W               &kp Q                &kp ESCAPE
&kp SINGLE_QUOTE  &kp SEMICOLON      &kp L              &kp K              &kp J              &kp H                                &kp G   &kp F              &kp D              &kp S               &kp A                &kp LEFT_BRACKET
&kp BACKSLASH     &hml RCTRL SLASH   &hml RALT DOT      &hml RCMD COMMA    &hml RSHFT M       &kp N   &none                &none   &kp B   &hmr LSHFT V       &hmr LCMD C        &hmr LALT X         &hmr LCTRL Z         &kp RIGHT_BRACKET
                                        &trans    &mml RIGHT_SHIFT BACKSPACE &mll 3 ENTER     &none   &none   &mlr 3 GRAVE   &mmr LEFT_SHIFT TAB &trans
            >;
        };

        layer_fn {
            display-name = "fn";
            bindings = <
&kp F1                &kp F2                &kp F3                             &kp F4             &kp F5               &kp F6                               &kp F7      &kp F8             &kp F9             &kp F10            &kp F11            &kp F12
&kp C_BRIGHTNESS_DEC  &kp C_BRIGHTNESS_INC  &kp C_AC_DESKTOP_SHOW_ALL_WINDOWS  &kp C_AC_SEARCH    &kp C_VOICE_COMMAND  &kp K_CANCEL                         &kp C_PREV  &kp C_PLAY_PAUSE   &kp C_NEXT         &kp C_MUTE         &kp C_VOL_DN       &kp C_VOL_UP
&bt BT_SEL 0          &bt BT_SEL 2          &none                              &kp UP             &none                &bt BT_SEL 4                         &none       &mkp LCLK          &mmv MOVE_UP       &mkp RCLK          &none              &studio_unlock
&bt BT_SEL 1          &bt BT_SEL 3          &hml LALT LEFT                     &hml LCMD DOWN     &hml LSHFT RIGHT     &bt BT_CLR      &none        &none   &none       &mmv MOVE_LEFT     &mmv MOVE_DOWN     &mmv MOVE_RIGHT    &kp RCTRL          &trans
                                        &trans          &none           &trans            &studio_unlock &studio_unlock &trans          &mo 3                 &trans
            >;
        };

        layer_nf {
            display-name = "nf";
            bindings = <
&kp F12         &kp F11          &kp F10             &kp F9              &kp F8             &kp F7                               &kp F6        &kp F5               &kp F4             &kp F3                             &kp F2        &kp F1
&kp C_VOL_UP    &kp C_VOL_DN     &kp C_MUTE          &kp C_NEXT          &kp C_PP           &kp C_PREV                           &kp K_CANCEL  &kp C_VOICE_COMMAND  &kp C_AC_SEARCH    &kp C_AC_DESKTOP_SHOW_ALL_WINDOWS  &kp C_BRI_UP  &kp C_BRI_DN
&studio_unlock  &none            &mkp RCLK           &mmv MOVE_UP        &mkp LCLK          &none                                &bt BT_SEL 4  &none                &kp UP             &none                              &bt BT_SEL 2  &bt BT_SEL 0
&trans          &kp RCTRL        &mmv MOVE_LEFT      &mmv MOVE_DOWN      &mmv MOVE_RIGHT    &none           &none        &none   &bt BT_CLR    &hmr LSHFT LEFT      &hmr LCMD DOWN      &hmr LALT RIGHT                    &bt BT_SEL 3  &bt BT_SEL 1
                                        &trans          &trans            &trans          &studio_unlock &studio_unlock &none           &trans                   &trans
            >;
        };

        layer_shift-esab {
            bindings = <
&kp LS(MINUS)  &kp LS(N0)          &kp LS(N9)          &kp LS(N8)          &kp LS(N7)         &kp LS(N6)                           &kp RS(N5)  &kp RS(N4)          &kp RS(N3)          &kp RS(N2)          &kp RS(N1)           &kp RS(GRAVE)
&kp LS(EQUAL)  &kp LS(P)           &kp LS(O)           &kp LS(I)           &kp LS(U)          &kp LS(Y)                            &kp RS(T)   &kp RS(R)           &kp RS(E)           &kp RS(W)           &kp RS(Q)            &kp RS(ESC)
&kp LS(SQT)    &kp LS(SEMI)        &kp LS(L)           &kp LS(K)           &kp LS(J)          &kp LS(H)                            &kp RS(G)   &kp RS(F)           &kp RS(D)           &kp RS(S)           &kp RS(A)            &kp RS(LBKT)
&kp LS(BSLH)   &hml RCTRL LS(FSLH) &hml RALT LS(DOT)   &hml RCMD LS(COMMA) &hml RSHFT LS(M)   &kp LS(N)     &none          &none   &kp RS(B)   &hmr LSHFT RS(V)    &hmr LCMD RS(C)     &hmr LALT RS(X)     &hmr LCTRL RS(Z)     &kp RS(RBKT)
                                        &kp LS(SPACE)  &kp LS(BACKSPACE)  &kp LS(ENTER)   &none          &none   &kp RS(GRAVE)  &kp RS(TAB)  &kp RS(SPACE)
            >;
        };
    };
};
